(this["webpackJsonpbbs-platform"]=this["webpackJsonpbbs-platform"]||[]).push([[0],{298:function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"userSignupRequest",(function(){return ie}));var s={};a.r(s),a.d(s,"addFlashMessage",(function(){return ce})),a.d(s,"deleteFlashMessage",(function(){return re}));var o,i,c,r=a(0),l=a.n(r),d=a(34),u=a.n(d),h=a(7),j=a(8),b=a(9),p=a(10),g=(a(134),a(144)),m=a(310),f=a(311),O=a(312),x=a(313),v=a(37),y=a(38),S=y.a.div(o||(o=Object(v.a)(["\n.side_bar{    \n    display: flex;\n    flex-direction: column;\n    position: fixed;\n    z-index: 1032;\n    top: 0;\n    left: 0;\n    width: 250px;\n    height: 100vh;\n    background: var(--gray-bg-pure);\n    overflow:auto;\n    background-color: #fff;\n}\n.side_bar_logo{\n    color: red;\n    font-size: 25px;\n    padding: 5%;\n    font-weight: 1000;\n    font-family: sans-serif;\n}\n::-webkit-scrollbar {\n    width: 1px;\n    height: 6px;\n    background-color: rgba(240, 240, 240, 1);\n  }\n   \n  /*\u5b9a\u4e49\u6eda\u52a8\u6761\u8f68\u9053 \u5185\u9634\u5f71+\u5706\u89d2*/\n  ::-webkit-scrollbar-track {\n    box-shadow: inset 0 0 0px rgba(240, 240, 240, .5);\n    border-radius: 10px;\n    background-color: rgba(240, 240, 240, .5);\n  }\n   \n  /*\u5b9a\u4e49\u6ed1\u5757 \u5185\u9634\u5f71+\u5706\u89d2*/\n  ::-webkit-scrollbar-thumb {\n    border-radius: 10px;\n    box-shadow: inset 0 0 0px rgba(240, 240, 240, .5);\n    background-color: rgba(240, 240, 240, .5);\n  }\n"]))),C=a(27),w=a(25),k=a(170),_=a.n(k),I=a(174),N=a(171),M=a(54),L="ADD_FLASH_MESSAGE",A="SET_CURRENT_USER",T="SET_CONFIG",D="SET_GLOBAL_CONFIG",E=a(172),R=a.n(E),W=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return e.type===A?{user:e.user,isAuth:!R()(e.user.username)}:t},z=a(11),B=a(173),U=a.n(B),H=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return e.type===L?[].concat(Object(z.a)(t),[{id:U.a.generate(),type:e.message.type,text:e.message.text}]):t},F=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return e.type===T?{config:e.config}:t},J=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return e.type===D?{globalConfig:e.globalConfig}:t},P=Object(M.combineReducers)({login:W,flashMessage:H,config:F,globalConfig:J}),Q=Object(M.createStore)(P,Object(N.composeWithDevTools)(Object(M.applyMiddleware)(_.a,I.a))),X=a(36),Y=a(3),G=g.a.SubMenu,K=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).renderMenuData=function(t){return t.map((function(t){return Object(Y.jsx)(g.a.Item,{onClick:function(){window.location.href=n.state.platform_address+t.key},children:t.title},t.key)}))},n.state={menuList:[],project_name:"",platform_address:""},n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;Q.subscribe((function(){if(Q.getState().config.config){var e=Q.getState().config.config.menu,a=t.renderMenuData(e);t.setState({menuList:a})}if(Q.getState().globalConfig.globalConfig){var n=Q.getState().globalConfig.globalConfig.menu;t.setState({project_name:n.project_name})}}))}},{key:"render",value:function(){return Object(Y.jsx)("div",{children:Object(Y.jsx)(S,{children:Object(Y.jsxs)("div",{className:"side_bar",children:[Object(Y.jsx)(C.b,{to:"/home",children:Object(Y.jsx)("span",{className:"side_bar_logo",children:this.state.project_name})}),Object(Y.jsxs)(g.a,{defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],mode:"inline",children:[Object(Y.jsx)(g.a.Item,{icon:Object(Y.jsx)(m.a,{}),children:Object(Y.jsx)(C.b,{to:"/home",children:"\u9996\u9875"})},"home"),Object(Y.jsx)(g.a.Item,{icon:Object(Y.jsx)(f.a,{}),children:Object(Y.jsx)(C.b,{to:"/articleList",children:"\u6587\u7ae0"})},"article"),Object(Y.jsx)(g.a.Item,{icon:Object(Y.jsx)(O.a,{}),children:"\u65b0\u95fb"},"news"),Object(Y.jsx)(G,{icon:Object(Y.jsx)(x.a,{}),title:"\u70ed\u95e8\u677f\u5757",children:this.state.menuList},"block")]})]})})})}}]),a}(l.a.Component),q=Object(X.withRouter)(Object(w.b)((function(t){return{config:t.config.config,globalConfig:t.globalConfig.globalConfig}}))(K)),V=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)("div",{children:Object(Y.jsx)("p",{children:"\u8fd9\u662f\u6587\u7ae0\u754c\u9762"})})}}]),a}(l.a.Component),Z=y.a.div(i||(i=Object(v.a)(["\nbody{\n    background-color: #f6f6f6;\n}\n.pageContainer{\n    display: flex;\n}\n.pagination{\n    text-align: center;\n}\n.menu{\n    align-items: center;\n    justify-content: center;\n}\n"]))),$=y.a.div(c||(c=Object(v.a)(["\n\n.head_picture{\n    width: ",";\n    height: ",";\n    margin: 15px;\n}\n.suggest_list{\n    width: ",";\n    height: ",";\n    margin: 15px;\n}\n.pageContainer{\n    display: flex;\n    justify-content: center;\n}\n"])),.67*document.body.clientWidth*.75+"px",.377*document.body.clientWidth*.75+"px",.23*document.body.clientWidth+"px",.377*document.body.clientWidth*.75+"px"),tt=a(304),et=a(141),at="http://localhost:8080",nt="BBSToken",st=a.n(et).a.create({baseURL:at});st.interceptors.response.use((function(t){return t.data&&311===t.data.code&&(localStorage.clear(),window.location.reload()),t}));var ot,it=st,ct={height:.377*document.body.clientWidth*.75,color:"#fff",lineHeight:"160px",textAlign:"center",background:"#364d79"},rt=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;Object(h.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).state={url:"",data:[]},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;it.get("/ad").then((function(e){t.setState({url:e.data.content.url})})),it.get("/recommend").then((function(e){t.setState({data:e.data.content.map((function(t){return Object(Y.jsx)("div",{children:Object(Y.jsx)(X.Link,{to:"/article/"+t.articleId,children:Object(Y.jsx)("img",{src:t.head_img,style:ct},t.id)})})}))})}))}},{key:"render",value:function(){return Object(Y.jsx)($,{children:Object(Y.jsxs)("div",{className:"pageContainer",children:[Object(Y.jsx)("div",{className:"head_picture",children:Object(Y.jsx)(tt.a,{autoplay:!0,children:this.state.data})}),Object(Y.jsx)("div",{className:"suggest_list",children:Object(Y.jsx)("img",{src:this.state.url,style:ct})})]})})}}]),a}(l.a.Component),lt=rt,dt=y.a.div(ot||(ot=Object(v.a)(["\n.site-card-wrapper {\n    padding:24px;\n  }\ncard{\n    margin:10px;\n}\n.description {\n  display: flex;\n  padding-top : 10px;\n  align-items: center;\n}\n.likeAndComment{\n  flex: 1;\n  text-align: right;\n  \n}\n"]))),ut=a(302),ht=a(307),jt=a(182),bt=a(314),pt=a(315);function gt(t){var e=36e5,a=24*e,n=(new Date).getTime()-t;if(!(n<0)){var s=n/2592e6,o=n/(7*a),i=n/a,c=n/e,r=n/6e4;return s>=1?s<=12?parseInt(s)+"\u6708\u524d":parseInt(s/12)+"\u5e74\u524d":o>=1?parseInt(o)+"\u5468\u524d":i>=1?parseInt(i)+"\u5929\u524d":c>=1?parseInt(c)+"\u5c0f\u65f6\u524d":r>=1?parseInt(r)+"\u5206\u949f\u524d":"\u521a\u521a"}}var mt,ft,Ot=ut.a.Meta,xt=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)(dt,{children:Object(Y.jsx)("div",{className:"site-card-wrapper",children:Object(Y.jsx)(ht.b,{grid:{gutter:24,column:5},dataSource:this.props.data,renderItem:function(t){return Object(Y.jsx)(ht.b.Item,{children:Object(Y.jsxs)(ut.a,{cover:Object(Y.jsx)("img",{src:t.head_img,alt:"item.title"}),children:[Object(Y.jsx)(X.Link,{to:{pathname:"/article/"+t.id},children:Object(Y.jsx)(Ot,{title:t.title})}),Object(Y.jsxs)("div",{className:"description",children:[Object(Y.jsx)(X.Link,{to:{pathname:"/user/"+t.user_id},children:Object(Y.jsx)(jt.a,{src:t.avatar})}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("span",{children:t.username}),Object(Y.jsx)("br",{}),Object(Y.jsx)("small",{children:gt(t.in_time)})]}),Object(Y.jsxs)("div",{className:"likeAndComment",children:[Object(Y.jsx)(bt.a,{}),t.collect_count,"\xa0",Object(Y.jsx)(pt.a,{}),t.comment_count]})]})]},t.id)})}})})})}}]),a}(l.a.Component),vt=xt,yt=a(180),St=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={data:[],pages:0},n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;it.get("/article/index").then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return Object(Y.jsx)(Z,{children:Object(Y.jsxs)("div",{className:"main",children:[Object(Y.jsx)(lt,{}),Object(Y.jsx)(vt,{data:this.state.data}),Object(Y.jsx)("div",{className:"pagination",children:Object(Y.jsx)(yt.a,{showQuickJumper:!0,defaultCurrent:1,total:this.state.total,onChange:function(e){it.get("/article/index",{params:{pageNo:e}}).then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))},justify:"center",pageSize:15})})]})})}}]),a}(l.a.Component),Ct=y.a.div(mt||(mt=Object(v.a)(["\n.header{\n    display: flex;\n    height: 60px;\n    margin-left: 250px;\n    background-color:#f7f7f76b;\n}\n.search{\n    margin: auto;\n}\n.menu{\n    margin-left: auto;\n}\n.after-login{\n    padding: 0px;\n}\n"]))),wt=a(305),kt=a(186),_t=a(301),It=a(317),Nt=function(t){t?it.defaults.headers.common.Authorization=t:delete it.defaults.headers.common.Authorization},Mt=function(t){return{type:A,user:t}},Lt={username:"",id:"",avatar:""},At=a(26),Tt=a(187),Dt=a(306),Et=a(316),Rt=g.a.SubMenu,Wt=wt.a.Search,zt=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;Object(h.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).state={current:"",not_read:0},t.onSearch=function(e){""!==e?window.location.href=t.props.globalConfig.menu.platform_address+"/searchPage?keywords="+e:kt.b.error("\u641c\u7d22\u8bcd\u4e0d\u80fd\u4e3a\u7a7a")},t.onLogout=function(){t.props.logout(),window.location.reload()},t.handleClick=function(e){t.setState({current:e.key})},t.componentDidMount=function(){Q.subscribe((function(){t.props.userState.isAuth&&t.initWebSocket(t.props.globalConfig.menu.websocket_address)}))},t.initWebSocket=function(e){var a=new WebSocket(e);a.onopen=function(){console.log("\u8fde\u63a5\u5efa\u7acb");var e,n,s={username:t.props.userState.user.username,userId:t.props.userState.user.id};e="bind",n=s,a.send(JSON.stringify({type:e,payload:n}))},a.onclose=function(){console.log("\u8fde\u63a5\u5173\u95ed")},a.onerror=function(t){console.log("\u51fa\u73b0\u5f02\u5e38",t)},a.onmessage=function(e){console.log("\u6536\u5230\u4fe1\u606f",e.data),"notification_notread"===(e=JSON.parse(e.data)).type&&t.setState({not_read:e.payload}),e.payload&&"notification_notread"!==e.type&&Tt.a.open({message:e.payload,icon:Object(Y.jsx)(Et.a,{style:{color:"#108ee9"}})})}},t}return Object(j.a)(a,[{key:"render",value:function(){var t=this.state.current,e=Object(Y.jsxs)(g.a,{className:"before-login",onClick:this.handleClick,selectedKeys:[t],mode:"horizontal",style:{height:60},children:[Object(Y.jsx)(g.a.Item,{children:Object(Y.jsx)(C.b,{to:"/signup",children:"\u6ce8\u518c"})},"signup"),Object(Y.jsx)(g.a.Item,{children:Object(Y.jsx)(C.b,{to:"/login",children:"\u767b\u5f55"})},"login")]}),a=Object(Y.jsxs)(g.a,{className:"after-login",onClick:this.handleClick,selectedKeys:[t],mode:"horizontal",style:{height:60,width:174},children:[Object(Y.jsx)(g.a.Item,{icon:Object(Y.jsx)(It.a,{}),children:Object(Y.jsx)(C.b,{to:"/create",children:"\u6295\u7a3f"})},"contribution"),Object(Y.jsxs)(Rt,{icon:Object(Y.jsx)(Dt.a,{count:this.state.not_read,children:Object(Y.jsx)(jt.a,{src:Object(Y.jsx)(_t.a,{src:this.props.userState.isAuth?this.props.userState.user.avatar:null,size:"small"})})}),children:[Object(Y.jsx)(g.a.Item,{children:Object(Y.jsx)(C.b,{to:"/myArticle",children:"\u6587\u7ae0"})},"myArticle"),Object(Y.jsx)(g.a.Item,{children:Object(Y.jsx)(C.b,{to:"/myCollect",children:"\u6536\u85cf"})},"myCollect"),Object(Y.jsx)(g.a.Item,{children:Object(Y.jsx)(C.b,{to:"/myMessage",children:"\u6d88\u606f"})},"myMessage"),Object(Y.jsx)(g.a.Item,{children:Object(Y.jsx)(C.b,{to:"/edit",children:"\u7f16\u8f91\u8d44\u6599"})},"edit"),Object(Y.jsx)(g.a.Item,{onClick:this.onLogout,children:"\u6ce8\u9500"},"logout")]},"user")]});return Object(Y.jsx)(Ct,{children:Object(Y.jsxs)("div",{className:"header",children:[Object(Y.jsx)("div",{className:"search",children:Object(Y.jsx)(Wt,{placeholder:"input search text",allowClear:!0,onSearch:this.onSearch,style:{width:400}})}),Object(Y.jsx)("div",{className:"menu",children:this.props.userState.isAuth?a:e})]})})}}]),a}(l.a.Component),Bt=Object(At.withRouter)(Object(w.b)((function(t){return{userState:t.login,globalConfig:t.globalConfig.globalConfig}}),{logout:function(){return function(t){localStorage.removeItem(nt),Nt(Lt),t(Mt(Lt))}}})(zt)),Ut=a(2),Ht=y.a.div(ft||(ft=Object(v.a)(["\n.content{\n    width: 50%;\n    margin: 0 auto;\n    margin-top: 30px;\n    line-height:40px;\n}\n.article_head{\n    display: flex;\n    justify-content: center;\n}\n.article_title{\n    width: ",";\n    height: ",";\n    padding: 50px;\n    padding-left: ",";\n}\n.title_img{\n    width: ",";\n    height: ",";\n}\n.description {\n    display: flex;\n    align-items: center;\n    margin-top:50px;\n  }\n.comment{\n    width: 50%;\n    margin: 0 auto;\n    margin-top: 30px;\n    line-height:40px;\n}\n.text{\n    margin-left: 40px;\n}\n.statement{\n    color: grey;\n}\n.modify{\n    margin-top:40px;\n}\na{\n    color: black;\n}\n"])),.45*(document.body.clientWidth-250)+"px",.253*(document.body.clientWidth-250)+"px",.45*(document.body.clientWidth-250)*.3+"px",.45*(document.body.clientWidth-250)+"px",.253*(document.body.clientWidth-250)+"px"),Ft=a(318),Jt=a(81),Pt=a(300),Qt=a(179),Xt=a.n(Qt),Yt=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(t){var n;Object(h.a)(this,a),(n=e.call(this,t)).fileChange=function(){n.setState({S:!0});var t=n._file.files[0];if(t){var e=new FileReader;e.readAsDataURL(t),e.onload=function(t){n.img=new Image,n.img.src=t.target.result,n.img.onload=function(){var t=1,e=n.state,a=e.W,s=e.H;n.IW=n.img.width,n.IH=n.img.height,n.IW>n.IH?(t=n.IW/a,n.IW=a,n.IH=n.IH/t):(t=n.IH/s,n.IH=s,n.IW=n.IW/t),n.IL=(a-n.IW)/2,n.IT=(s-n.IH)/2,n.drawImage()}}}},n.drawImage=function(){var t=n.state,e=t.W,a=t.H;n.ctx=n._canvas.getContext("2d"),n.ctx.clearRect(0,0,e,a),n.ctx.drawImage(n.img,n.IL,n.IT,n.IW,n.IH)},n.canvasToFile=function(t){for(var e=t.toDataURL("image/jpg").split(","),a=e[0].match(/:(.*?);/)[1],n=atob(e[1]),s=n.length,o=new Uint8Array(s);s--;)o[s]=n.charCodeAt(s);return new File([o],"generate.jpg",{type:a})};var s=n.props.width,o=n.props.height,i=.9*s,c=i*n.props.height/n.props.width,r=(s-i)/2,l=(o-c)/2;return n.state={W:s,H:o,MW:i,MH:c,ML:r,MT:l,S:!1,MouseDown:!1,url:""},n}return Object(j.a)(a,[{key:"render",value:function(){var t=this,e=this.state,a=e.W,n=e.H,s=e.MW,o=e.MH,i=e.MT,c=e.ML,r=e.S;return Object(Y.jsxs)("div",{className:"clipImageBox",style:{position:"relative"},children:[Object(Y.jsxs)("div",{className:"canvasBoxDiv",onMouseDown:function(e){t.startX=e.clientX,t.startY=e.clientY,t.setState({MouseDown:!0})},onMouseMove:function(e){if(t.state.MouseDown){var a=e.clientX-t.startX,n=e.clientY-t.startY;t.IL+=a,t.IT+=n,t.drawImage(),t.startX=e.clientX,t.startY=e.clientY}},onMouseUp:function(e){t.setState({MouseDown:!1})},children:[Object(Y.jsx)("canvas",{className:"canvasBox",ref:function(e){return t._canvas=e},width:a,height:n,style:{borderStyle:"solid"}}),Object(Y.jsx)("div",{className:"mark",style:{width:s+"px",height:o+"px",left:c+"px",top:i+"px",display:r?"block":"none",backgroundColor:"#123123",opacity:.3,position:"absolute",zIndex:20}})]}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("input",{type:"file",accept:"image/*",className:"file",ref:function(e){t._file=e},style:{display:"none"},onChange:this.fileChange}),Object(Y.jsx)("button",{className:"choose",onClick:function(){t._file.click()},children:"\u9009\u62e9\u56fe\u7247"}),Object(Y.jsx)("button",{onClick:function(e){t.img&&(t.IW+=10,t.IH+=t.img.height/t.img.width*10,t.drawImage())},children:"\u653e\u5927"}),Object(Y.jsx)("button",{onClick:function(e){t.img&&(t.IW-=10,t.IH-=t.img.height/t.img.width*10,t.drawImage())},children:"\u7f29\u5c0f"}),Object(Y.jsx)("button",{className:"submit",onClick:function(e){if(t.img){var a=t.ctx.getImageData(c,i,s,o),n=document.createElement("canvas"),r=n.getContext("2d");n.width=s,n.height=o,r.putImageData(a,0,0,0,0,s,o);var l=new FormData;l.append("file",t.canvasToFile(n)),l.append("type",t.props.type),t.setState({uploading:!0}),it.post("/upload/",l).then((function(e){if(200===e.data.code)t.setState({url:e.data.content.urls[0]}),t.props.change(t.state.url),kt.b.success("\u56fe\u7247\u4e0a\u4f20\u6210\u529f");else if(e.data.content){for(var a="",n=0;n<e.data.content.errors.length;n++)a+=e.data.content.errors[n]+"<br/>";kt.b.error(a)}else kt.b.error(e.data.message)})).catch((function(t){console.log("axios error ",t)}))}},children:"\u4fdd\u5b58\u56fe\u7247"}),Object(Y.jsx)("button",{onClick:function(){t.props.back()},children:"\u653e\u5f03\u4e0a\u4f20"})]})]})}}]),a}(l.a.Component),Gt=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).change=function(t){n.setState({stage:0}),n.setState({url:t}),n.props.getUrl(t)},n.back=function(){n.setState({stage:0})},n.state={stage:0,url:""},n}return Object(j.a)(a,[{key:"render",value:function(){var t=this,e=this.state.stage,a="";return a=this.props.url&&""===this.state.url?this.props.url:this.state.url,Object(Y.jsxs)("div",{children:[Object(Y.jsxs)("div",{className:"baseInfo",style:{display:0===e?"block":"none"},children:[Object(Y.jsx)("div",{className:"imgBox",onClick:function(){t.setState({stage:1})},style:{display:""===a?"none":"block"},children:Object(Y.jsx)("img",{src:a,alt:""})}),Object(Y.jsxs)("div",{className:"messageBox",onClick:function(){t.setState({stage:1})},style:{display:""===a?"block":"none",backgroundColor:"#ccc"},children:[Object(Y.jsx)("br",{}),Object(Y.jsx)("p",{style:{textAlign:"center"},children:this.props.uploadTitle}),Object(Y.jsx)("p",{style:{textAlign:"center"},children:this.props.uploadContent}),Object(Y.jsx)("br",{})]})]}),Object(Y.jsx)("div",{className:"ImageClip",style:{display:0===e?"none":"block"},children:Object(Y.jsx)(Yt,{change:this.change,back:this.back,type:this.props.type,width:this.props.width,height:this.props.height})})]})}}]),a}(l.a.Component);function Kt(t){for(var e=t.valueOf();-1!=e.indexOf("\uff0c");)t=e.replace("\uff0c",",").valueOf(),e=t.valueOf();return t=e.valueOf()}var qt=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={editorContent:"",headImg:"",title:"",tag:"",isLoading:!1,operation:"/save/",type:"headImg",width:.5*(document.documentElement.clientWidth-250),height:.5*(document.documentElement.clientWidth-250)*9/16,uploadTitle:"\u9009\u62e9\u6587\u7ae0\u5934\u56fe",uploadContent:"",max_upload_image_size:3,max_upload_file_num:3,file_upload_timeout:3},n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.props.globalConfig&&(this.setState({max_upload_image_size:this.props.globalConfig.menu.max_upload_image_size}),this.setState({max_upload_file_num:this.props.globalConfig.menu.max_upload_file_num}),this.setState({file_upload_timeout:this.props.globalConfig.file_upload_timeout}),this.setState({uploadContent:"\u8bf7\u63d2\u5165\u6587\u4ef6\u5c0f\u4e8e"+this.props.globalConfig.menu.max_upload_image_size+"M\uff0c\u683c\u5f0f\u4e3apng,jpg,jpeg,gif\u768416:9\u56fe\u7247"}));var e=this.refs.editorElemMenu,a=this.refs.editorElemBody,n=new Xt.a(e,a);n.config.onchange=function(e){t.setState({editorContent:n.txt.html()})},n.config.menus=["head","bold","italic","strikeThrough","link","list","justify","quote","emoticon","image","table","video","code","undo","redo"],n.config.uploadImgServer=at+"/upload",n.config.uploadImgMaxSize=1024*this.state.max_upload_image_size*1024,n.config.uploadImgMaxLength=this.state.max_upload_file_num,n.config.uploadImgTimeout=this.state.file_upload_timeout,n.config.customUploadImg=function(t,e){!function(t,e){for(var a=new FormData,n=0;n<t.length;n++)a.append("file",t[n]);a.append("type","article"),it.post("/upload/",a).then((function(t){200===t.data.code?(kt.b.success("\u4e0a\u4f20\u6210\u529f"),e(t.data)):kt.b.error(t.data.message)})).catch((function(t){console.log("axios error ",t)}))}(t,(function(t){for(var a=0;a<t.content.urls.length;a++){var n=t.content.urls[a];e(n)}}))},this.props.operation?(this.setState({operation:"/update/"+this.props.operation.replace("/article/","")}),it.get(this.props.operation).then((function(e){200===e.data.code?(t.setState({editorContent:e.data.content.content}),t.setState({headImg:e.data.content.headImg}),t.setState({title:e.data.content.title}),t.setState({tag:e.data.content.list.map((function(t){return t.name})).join(",")}),n.create(),n.txt.html(t.state.editorContent)):(kt.b.error(e.data.message),window.location.href="/")})).catch((function(t){console.log(t)}))):(n.create(),n.txt.html(this.state.editorContent))}},{key:"render",value:function(){var t=this;return Object(Y.jsx)(Ht,{children:Object(Y.jsxs)("div",{className:"content",children:[Object(Y.jsx)("div",{className:"head-img",children:Object(Y.jsx)(Gt,{getUrl:this.getUrl.bind(this),type:this.state.type,width:this.state.width,height:this.state.height,uploadTitle:this.state.uploadTitle,uploadContent:this.state.uploadContent,url:this.state.headImg})}),Object(Y.jsx)("div",{style:{marginTop:"20px",marginBottom:"20px"},children:Object(Y.jsx)(wt.a,{placeholder:"\u8bf7\u8f93\u5165\u6807\u9898",value:this.state.title,bordered:!1,onChange:function(e){t.setState({title:e.target.value})},size:"large"})}),Object(Y.jsx)("hr",{}),Object(Y.jsx)("div",{style:{marginTop:"20px",marginBottom:"20px"},children:Object(Y.jsx)(wt.a,{placeholder:"\u8bf7\u8f93\u5165\u6807\u7b7e,\u4e0d\u5fc5\u8f93\u5165#\uff0c\u6807\u7b7e\u4e4b\u95f4\u8bf7\u4f7f\u7528\u9017\u53f7\u5206\u5272",value:this.state.tag,bordered:!1,onChange:function(e){t.setState({tag:e.target.value})},size:"large"})}),Object(Y.jsx)("div",{ref:"editorElemMenu",style:{backgroundColor:"#f1f1f1",border:"1px solid #ccc"},className:"editorElem-menu"}),Object(Y.jsx)("div",{style:{padding:"0 10px",border:"0px solid #ccc",borderTop:"none"},ref:"editorElemBody",className:"editorElem-body"}),Object(Y.jsx)(Jt.a,{disabled:this.state.isLoading,onClick:function(){""!==t.state.title?""!==t.state.headImg?""!==t.state.editorContent?(t.setState({isLoading:!0}),it.post("/article"+t.state.operation,{title:t.state.title,content:t.state.editorContent,headImg:t.state.headImg,tag:Kt(t.state.tag)}).then((function(e){200===e.data.code?(kt.b.success("\u4e0a\u4f20\u6210\u529f"),window.location.href="/"):kt.b.error(e.data.message),t.setState({isLoading:!1})})).catch((function(t){console.log("axios error ",t)}))):kt.b.error("\u8bf7\u8f93\u5165\u6b63\u6587"):kt.b.error("\u8bf7\u4e0a\u4f20\u5934\u56fe"):kt.b.error("\u8bf7\u8f93\u5165\u6807\u9898")},children:" \u4e0a\u4f20\u6587\u7ae0 "})]})})}},{key:"getUrl",value:function(t){this.setState({headImg:t})}}]),a}(l.a.Component),Vt=Object(X.withRouter)(Object(w.b)((function(t){return{userState:t.login,globalConfig:t.globalConfig.globalConfig}}))(qt)),Zt=wt.a.TextArea,$t=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).isUserCollect=function(){t.state.isAuth&&it.get("/collect/"+t.state.id).then((function(e){200===e.data.code?t.setState({isCollect:e.data.content}):kt.b.error(e.data.message)}))},t.collect=function(){t.setState({isLoading:!0});var e=t.state.collectCount+1;it.post("/collect/"+t.state.id).then((function(a){200===a.data.code?(kt.b.success("\u6536\u85cf\u6210\u529f"),t.setState({isCollect:!0}),t.setState({collectCount:e})):kt.b.error(a.data.message),t.setState({isLoading:!1})}))},t.unCollect=function(){t.setState({isLoading:!0});var e=t.state.collectCount-1;it.delete("/collect/"+t.state.id).then((function(a){200===a.data.code?(kt.b.success("\u53d6\u6d88\u6536\u85cf\u6210\u529f"),t.setState({isCollect:!1}),t.setState({collectCount:e})):kt.b.error(a.data.message),t.setState({isLoading:!1})})),t.setState({isLoading:!1})},t.renderTag=function(e){return e.map((function(e){return Object(Y.jsx)(Jt.a,{shape:"round",style:{marginRight:"5px"},onClick:function(){window.location.href=t.state.platform_address+"/tag/"+e.id},children:"#"+e.name},e.name)}))},t.onChange=function(e){t.setState(Object(Ut.a)({},e.target.name,e.target.value))},t.onSubmit=function(){t.setState({isCommentSendLoading:!0}),it.post("/comment/"+t.state.id,{comment:t.state.commentContent}).then((function(e){200===e.data.code?(kt.b.success("\u8bc4\u8bba\u53d1\u5e03\u6210\u529f"),window.location.reload()):kt.b.error(e.data.message),t.setState({isCommentSendLoading:!1})}))},t.state={username:"",avatar:"",userAvatar:"",comment:[],isAuth:!1,isAuthor:!1,isCollect:!1,isLoading:!1,isCommentSendLoading:!1,stage:!0,tagList:[],platform_address:""},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;Q.subscribe((function(){if(Q.getState().globalConfig.globalConfig){var e=Q.getState().globalConfig.globalConfig.menu;t.setState({project_name:e.project_name})}var a=Q.getState().login;t.setState({isAuth:a.isAuth}),t.setState({userAvatar:a.user.avatar}),a.user.username===t.state.username?t.setState({isAuthor:!0}):t.setState({isAuthor:!1}),t.isUserCollect()})),it.get(this.props.location.pathname).then((function(e){200===e.data.code?(console.log(e.data.content),t.setState({id:e.data.content.id}),t.setState({userId:e.data.content.userId}),t.setState({content:e.data.content.content}),t.setState({head_img:e.data.content.headImg}),t.setState({title:e.data.content.title}),t.setState({avatar:e.data.content.avatar}),t.setState({inTime:e.data.content.inTime}),t.setState({commentCount:e.data.content.commentCount}),t.setState({collectCount:e.data.content.collectCount}),t.setState({view:e.data.content.view}),t.setState({username:e.data.content.username}),t.setState({comment:e.data.content.comments}),t.setState({tagList:t.renderTag(e.data.content.list)}),t.setState({userAvatar:t.props.userState.user.avatar}),t.setState({isAuth:t.props.userState.isAuth}),t.props.userState.user.username===t.state.username?t.setState({isAuthor:!0}):t.setState({isAuthor:!1}),t.isUserCollect()):(kt.b.error(e.data.message),window.location.href=t.state.platform_address)})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return Object(Y.jsxs)(Ht,{children:[Object(Y.jsx)("div",{style:{display:this.state.stage?"none":"block"},children:Object(Y.jsx)(Vt,{operation:this.props.location.pathname})}),Object(Y.jsxs)("div",{style:{display:this.state.stage?"block":"none"},children:[Object(Y.jsxs)("div",{className:"article_head",children:[Object(Y.jsxs)("div",{className:"article_title",children:[Object(Y.jsx)("h1",{children:this.state.title}),Object(Y.jsxs)("div",{className:"description",children:[Object(Y.jsx)(X.Link,{to:{pathname:"/user/"+this.state.userId},children:Object(Y.jsx)(jt.a,{src:this.state.avatar})}),Object(Y.jsxs)("div",{className:"text",children:[Object(Y.jsx)("span",{children:this.state.username}),Object(Y.jsx)("br",{}),Object(Y.jsx)("small",{children:gt(this.state.inTime)})]})]}),Object(Y.jsxs)("div",{className:"modify",style:{display:this.state.isAuthor?"block":"none"},children:[Object(Y.jsx)("a",{onClick:function(){it.delete(t.props.location.pathname).then((function(t){200===t.data.code?(kt.b.success("\u5220\u9664\u6210\u529f"),window.location.href="/"):kt.b.error(t.data.message)})).catch((function(t){console.log(t)}))},children:"\u5220\u9664"}),"\xa0\xa0\xa0\xa0",Object(Y.jsx)("a",{onClick:function(){t.setState({stage:!1})},children:"\u4fee\u6539"})]})]}),Object(Y.jsx)("div",{children:Object(Y.jsx)(_t.a,{className:"title_img",src:this.state.head_img})})]}),Object(Y.jsxs)("div",{className:"content",children:[Object(Y.jsx)("div",{className:"statement",children:Object(Y.jsx)("p",{children:Object(Y.jsx)("small",{children:"\u672c\u6587\u7cfb\u53d1\u5e03\u8005\u6295\u7a3f\uff0c\u6587\u7ae0\u5185\u5bb9\u4e0d\u4ee3\u8868\u672c\u7ad9\u89c2\u70b9"})})}),Object(Y.jsx)("div",{dangerouslySetInnerHTML:{__html:this.state.content}}),this.state.tagList,Object(Y.jsx)("br",{}),Object(Y.jsxs)(Jt.a,{icon:Object(Y.jsx)(Ft.a,{style:{color:this.state.isCollect?"#1890ff":"#969faf"}}),disabled:this.state.isLoading||!this.state.isAuth,onClick:this.state.isCollect?this.unCollect:this.collect,children:["\xa0\xa0",this.state.collectCount,"\xa0\xa0"]}),Object(Y.jsx)("br",{}),Object(Y.jsx)("hr",{})]}),Object(Y.jsxs)("div",{className:"comment",children:[Object(Y.jsxs)("div",{className:"addComment",style:{display:this.state.isAuth?"flex":"none",marginBottom:"24px"},children:[Object(Y.jsx)(jt.a,{src:this.state.userAvatar,style:{float:"left",alignSelf:"center"}}),Object(Y.jsx)(Zt,{rows:2,style:{width:"80%",marginLeft:"20px",marginRight:"10px"},name:"commentContent",onChange:this.onChange}),Object(Y.jsx)(Jt.a,{style:{float:"right",alignSelf:"center"},onClick:this.onSubmit,disabled:this.state.isCommentSendLoading,children:"\u53d1\u9001"})]}),Object(Y.jsx)(ht.b,{className:"comment-list",header:"".concat(this.state.comment.length," \u6761\u56de\u590d"),itemLayout:"horizontal",dataSource:this.state.comment,renderItem:function(t){return Object(Y.jsx)("li",{children:Object(Y.jsx)(Pt.a,{author:t.username,avatar:t.avatar,content:t.content,datetime:gt(t.inTime)})})}})]})]})]})}}]),a}(l.a.Component),te=Object(At.withRouter)(Object(w.b)((function(t){return{userState:t.login,globalConfig:t.globalConfig.globalConfig}}))($t));function ee(t){var e=window.location.search,a=new Object;if(-1!=e.indexOf("?"))for(var n=e.substr(1).split("&"),s=0;s<n.length;s++)a[n[s].split("=")[0]]=decodeURI(n[s].split("=")[1]);return a[t]}var ae,ne=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).state={data:[],pages:0},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;console.log(ee("keywords")),it.post("/article/search",{keyword:ee("keywords")}).then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return Object(Y.jsx)(Z,{children:Object(Y.jsxs)("div",{className:"main",children:[Object(Y.jsx)(vt,{data:this.state.data}),Object(Y.jsx)("div",{className:"pagination",children:Object(Y.jsx)(yt.a,{showQuickJumper:!0,defaultCurrent:1,total:this.state.total,onChange:function(e){it.post("/article/search",{keyword:ee("keywords"),pageNo:e}).then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))},justify:"center",pageSize:15})})]})})}}]),a}(l.a.Component),se=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).onChange=function(e){t.setState(Object(Ut.a)({},e.target.name,e.target.value))},t.onSubmit=function(e){e.preventDefault(),t.state.password===t.state.repeat_password?(t.setState({isLoading:!0}),t.props.signupActions.userSignupRequest(t.state).then((function(e){200!==e.data.code?(t.props.flashActions.addFlashMessage({type:"error",text:e.data.message}),t.setState({errors:e.data.message,isLoading:!1})):(t.props.flashActions.addFlashMessage({type:"success",text:"\u6ce8\u518c\u6210\u529f\uff01\u8bf7\u8fdb\u884c\u767b\u5f55\uff01"}),t.props.history.replace("/"))})).catch((function(t){console.log(t)}))):kt.b.error("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4")},t.state={username:"",email:"",password:"",repeat_password:"",errors:{},isLoading:!1},t}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)("div",{children:Object(Y.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(Y.jsx)("h1",{children:"\u6ce8\u518c"}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("label",{children:"username"}),Object(Y.jsx)("input",{name:"username",value:this.state.username,onChange:this.onChange,type:"text"})]}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("label",{children:"password"}),Object(Y.jsx)("input",{name:"password",value:this.state.password,onChange:this.onChange,type:"password"})]}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("label",{children:"repeat_password"}),Object(Y.jsx)("input",{name:"repeat_password",value:this.state.repeat_password,onChange:this.onChange,type:"password"})]}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("label",{children:"email"}),Object(Y.jsx)("input",{name:"email",value:this.state.email,onChange:this.onChange,type:"email"})]}),Object(Y.jsx)("div",{children:Object(Y.jsx)("button",{disabled:this.state.isLoading,children:"\u6ce8\u518c"})})]})})}}]),a}(l.a.Component),oe=Object(At.withRouter)(se),ie=function(t){return function(e){return it.post("/signup",t)}},ce=function(t){return{type:L,message:t}},re=function(t){return{type:"DELETE_FLASH_MESSAGE",message:kt.b}},le=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)("div",{children:Object(Y.jsx)(oe,{flashActions:this.props.flashActions,signupActions:this.props.signupActions})})}}]),a}(l.a.Component),de=Object(w.b)(null,(function(t){return{signupActions:Object(M.bindActionCreators)(n,t),flashActions:Object(M.bindActionCreators)(s,t)}}))(le),ue=a(308),he=y.a.div(ae||(ae=Object(v.a)(["\n.container{\n    margin-left: 250px;\n}\n"]))),je=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)(he,{children:Object(Y.jsx)("div",{className:"container",children:this.props.messages.map((function(t,e){return Object(Y.jsx)(ue.a,{message:t.text,type:t.type,showIcon:!0,closable:!0},e)}))})})}}]),a}(l.a.Component),be=Object(w.b)((function(t){return{messages:t.flashMessage}}))(je),pe=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).onChange=function(e){t.setState(Object(Ut.a)({},e.target.name,e.target.value))},t.onSubmit=function(e){e.preventDefault(),t.setState({isLoading:!0}),t.props.login(t.state).then((function(e){if(200!==e.data.code)t.props.addFlashMessage({type:"error",text:e.data.message}),t.setState({errors:e.data.message,isLoading:!1});else{var a=e.data.content.token;localStorage.setItem(nt,a),Nt(a),t.props.addFlashMessage({type:"success",text:"\u767b\u5f55\u6210\u529f\uff01"});var n={id:e.data.content.user.id,username:e.data.content.user.username,avatar:e.data.content.user.avatar};Q.dispatch(Mt(n)),t.props.history.replace("/")}})).catch((function(t){console.log(t)}))},t.state={username:"",password:"",errors:{},isLoading:!1},t}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)("div",{children:Object(Y.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(Y.jsx)("h1",{children:"\u767b\u5f55"}),Object(Y.jsxs)("div",{className:"form-group",children:[Object(Y.jsx)("label",{className:"control-label",children:"username"}),Object(Y.jsx)("input",{name:"username",value:this.state.username,onChange:this.onChange,type:"text",className:"form-control"})]}),Object(Y.jsxs)("div",{className:"form_group",children:[Object(Y.jsx)("label",{className:"control_label",children:"password"}),Object(Y.jsx)("input",{name:"password",value:this.state.password,onChange:this.onChange,type:"password",className:"form_control"})]}),Object(Y.jsx)("div",{className:"form_group",children:Object(Y.jsx)("button",{disabled:this.state.isLoading,children:"\u767b\u5f55"})})]})})}}]),a}(l.a.Component),ge=Object(At.withRouter)(Object(w.b)(null,{login:function(t){return function(e){return it.post("/login",t)}},addFlashMessage:ce})(pe)),me=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)("div",{children:Object(Y.jsx)(ge,{flashActions:this.props.flashActions})})}}]),a}(l.a.Component),fe=me;var Oe=a(303),xe=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).state={data:[],pages:0},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;it.get("/article/user/"+this.props.userState.user.id).then((function(e){200===e.data.code?(t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})):(kt.b.error(e.data.messgae),window.location.href="/")})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return this.props.userState.isAuth||(kt.b.error("\u8bf7\u5148\u767b\u5f55!"),window.location.href="/"),Object(Y.jsx)(Z,{children:Object(Y.jsxs)("div",{className:"main",children:[Object(Y.jsx)(Oe.a,{className:"site-page-header",onBack:function(){window.history.back(-1)},title:"\u53d1\u8868\u7684\u6587\u7ae0"}),",",Object(Y.jsx)(vt,{data:this.state.data}),Object(Y.jsx)("div",{className:"pagination",children:Object(Y.jsx)(yt.a,{showQuickJumper:!0,defaultCurrent:1,total:this.state.total,onChange:function(e){it.get("/article/user/"+t.props.userState.user.id,{pageNo:e}).then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))},justify:"center",pageSize:15})})]})})}}]),a}(l.a.Component),ve=Object(At.withRouter)(Object(w.b)((function(t){return{userState:t.login,globalConfig:t.globalConfig.globalConfig}}))(xe)),ye=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).state={data:[],pages:0},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;it.get("/article/collect/"+this.props.userState.user.id).then((function(e){200===e.data.code?(t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})):(kt.b.error(e.data.messgae),window.location.href="/")})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return this.props.userState.isAuth||(kt.b.error("\u8bf7\u5148\u767b\u5f55!"),window.location.href="/"),Object(Y.jsx)(Z,{children:Object(Y.jsxs)("div",{className:"main",children:[Object(Y.jsx)(Oe.a,{className:"site-page-header",onBack:function(){window.history.back(-1)},title:this.props.userState.user.username+"\u6536\u85cf\u7684\u6587\u7ae0"}),Object(Y.jsx)(vt,{data:this.state.data}),Object(Y.jsx)("div",{className:"pagination",children:Object(Y.jsx)(yt.a,{showQuickJumper:!0,defaultCurrent:1,total:this.state.total,onChange:function(e){it.get("/article/collect/"+t.props.userState.user.id,{pageNo:e}).then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))},justify:"center",pageSize:15})})]})})}}]),a}(l.a.Component),Se=Object(At.withRouter)(Object(w.b)((function(t){return{userState:t.login}}))(ye)),Ce=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){return Object(Y.jsx)("div",{children:Object(Y.jsx)(Vt,{})})}}]),a}(l.a.Component),we=Ce,ke=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).onChange=function(e){t.setState(Object(Ut.a)({},e.target.name,e.target.value))},t.userMessageClick=function(e){e.preventDefault(),t.setState({isUserMessageLoading:!0}),it.post("/user/update",{username:t.state.username,bio:t.state.bio,email:t.state.email}).then((function(e){if(200!==e.data.code)kt.b.error(e.data.message);else{kt.b.success("\u66f4\u65b0\u6210\u529f\uff01");var a={username:"",id:"",avatar:""};a.username=t.state.username,a.id=t.state.id,a.avatar=t.state.avatar,Q.dispatch(Mt(a))}t.setState({isUserMessageLoading:!1})})).catch((function(t){console.log(t)}))},t.passwordClick=function(e){e.preventDefault(),t.state.password===t.state.repeat_password?(t.setState({isPasswordLoading:!0}),it.post("/user/updatepwd",{password:t.state.password,old_password:t.state.old_password}).then((function(e){200!==e.data.code?kt.b.error(e.data.message):kt.b.success("\u66f4\u65b0\u6210\u529f\uff01"),t.setState({isPasswordLoading:!1})})).catch((function(t){console.log(t)}))):kt.b.error("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4")},t.state={id:"",username:"",bio:"",avatar:"",type:"avatar",width:150,height:150,uploadTitle:"\u9009\u62e9\u7528\u6237\u5934\u50cf",uploadContent:"",isUserMessageLoading:!1,isPasswordLoading:!1,password:"",old_password:"",repeat_password:""},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.setState({uploadContent:"\u8bf7\u63d2\u5165\u6587\u4ef6\u5c0f\u4e8e"+this.props.globalConfig.menu.max_upload_image_size+"M\uff0c\u683c\u5f0f\u4e3apng,jpg,jpeg,gif\u768416:9\u56fe\u7247"}),it.get("/user/token").then((function(e){if(200===e.data.code){if(e.data.content.id!==t.props.userState.user.id)return void kt.b.error("\u8bf7\u4f7f\u7528\u81ea\u5df1\u7684\u8d26\u53f7");t.setState({id:e.data.content.id}),t.setState({username:e.data.content.username}),t.setState({email:e.data.content.email}),t.setState({bio:e.data.content.bio}),t.setState({avatar:e.data.content.avatar})}else kt.b.error(e.data.message),window.location.href="/"})).catch((function(t){console.log(t)}))}},{key:"getUrl",value:function(t){var e={username:"",id:"",avatar:""};e.username=this.props.userState.user.username,e.id=this.props.userState.user.id,e.avatar=t,Q.dispatch(Mt(e)),this.setState({avatar:t})}},{key:"render",value:function(){return this.props.userState.isAuth||(kt.b.error("\u8bf7\u5148\u767b\u5f55!"),window.location.href="/"),Object(Y.jsxs)("div",{children:[Object(Y.jsx)(Oe.a,{className:"site-page-header",onBack:function(){window.history.back(-1)},title:"\u7f16\u8f91\u4e2a\u4eba\u4fe1\u606f"}),",",Object(Y.jsxs)("div",{className:"content",style:{width:"50%",lineHeight:"30px",margin:"0 auto",padding:"24px"},children:[Object(Y.jsxs)("div",{style:{backgroundColor:"#EEEEF2",padding:"24px"},children:[Object(Y.jsx)("h1",{style:{marginBottom:"24px"},children:"\u4e2a\u4eba\u4fe1\u606f"}),Object(Y.jsx)("hr",{}),Object(Y.jsxs)("div",{style:{marginTop:"15px"},children:[Object(Y.jsx)("h3",{children:Object(Y.jsx)("b",{children:"\u7528\u6237\u540d"})}),Object(Y.jsx)(wt.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",value:this.state.username,name:"username",onChange:this.onChange})]}),Object(Y.jsxs)("div",{style:{marginTop:"24px"},children:[Object(Y.jsx)("h3",{children:Object(Y.jsx)("b",{children:"\u81ea\u6211\u7b80\u4ecb"})}),Object(Y.jsx)(wt.a,{placeholder:"\u8bf7\u8f93\u5165\u81ea\u6211\u7b80\u4ecb",value:this.state.bio,name:"bio",onChange:this.onChange})]}),Object(Y.jsxs)("div",{style:{marginTop:"24px"},children:[Object(Y.jsx)("h3",{children:Object(Y.jsx)("b",{children:"\u90ae\u7bb1\u5730\u5740"})}),Object(Y.jsx)(wt.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1",value:this.state.email,name:"email",onChange:this.onChange})]}),Object(Y.jsx)(Jt.a,{style:{marginTop:"24px"},onClick:this.userMessageClick,disabled:this.state.isUserMessageLoading,children:"\u63d0\u4ea4"})]}),Object(Y.jsxs)("div",{style:{marginTop:"24px",backgroundColor:"#EEEEF2",padding:"24px"},children:[Object(Y.jsx)("h1",{style:{marginBottom:"24px"},children:"\u4fee\u6539\u4e2a\u4eba\u5934\u50cf"}),Object(Y.jsx)("hr",{}),Object(Y.jsxs)("div",{style:{marginTop:"24px"},children:[Object(Y.jsx)("h3",{children:Object(Y.jsx)("b",{children:"\u7528\u6237\u5934\u50cf"})}),Object(Y.jsx)("div",{style:{width:"330px"},children:Object(Y.jsx)(Gt,{getUrl:this.getUrl.bind(this),type:this.state.type,width:this.state.width,height:this.state.height,uploadTitle:this.state.uploadTitle,uploadContent:this.state.uploadContent,url:this.state.avatar})})]})]}),Object(Y.jsxs)("div",{style:{marginTop:"24px",backgroundColor:"#EEEEF2",padding:"24px"},children:[Object(Y.jsx)("h1",{style:{marginBottom:"24px"},children:"\u4fee\u6539\u5bc6\u7801"}),Object(Y.jsx)("hr",{}),Object(Y.jsxs)("div",{style:{marginTop:"15px"},children:[Object(Y.jsx)("h3",{children:Object(Y.jsx)("b",{children:"\u539f\u5bc6\u7801"})}),Object(Y.jsx)(wt.a.Password,{placeholder:"",value:this.state.old_password,name:"old_password",onChange:this.onChange})]}),Object(Y.jsxs)("div",{style:{marginTop:"24px"},children:[Object(Y.jsx)("h3",{children:Object(Y.jsx)("b",{children:"\u65b0\u5bc6\u7801"})}),Object(Y.jsx)(wt.a.Password,{placeholder:"",value:this.state.password,name:"password",onChange:this.onChange})]}),Object(Y.jsxs)("div",{style:{marginTop:"24px"},children:[Object(Y.jsx)("h3",{children:Object(Y.jsx)("b",{children:"\u91cd\u590d\u65b0\u5bc6\u7801"})}),Object(Y.jsx)(wt.a.Password,{placeholder:"",value:this.state.repeat_password,name:"repeat_password",onChange:this.onChange})]}),Object(Y.jsx)(Jt.a,{style:{marginTop:"24px"},onClick:this.passwordClick,disabled:this.state.isPasswordLoading,children:"\u63d0\u4ea4"})]})]})]})}}]),a}(l.a.Component),_e=Object(X.withRouter)(Object(w.b)((function(t){return{userState:t.login,globalConfig:t.globalConfig.globalConfig}}))(ke));function Ie(){var t={menu:[]};it.get("/config").then((function(e){t.menu=e.data.content,Q.dispatch(function(t){return{type:T,config:t}}(t))})).catch((function(t){console.log(t)}))}var Ne;function Me(){var t={menu:[]};it.get("/systemconfig").then((function(e){t.menu=e.data.content,Q.dispatch(function(t){return{type:D,globalConfig:t}}(t))})).catch((function(t){console.log(t)}))}var Le=y.a.div(Ne||(Ne=Object(v.a)(["\n.circle{\n    height: 200px;\n    overflow:hidden;\n}\n  .circle-shadow {\n    margin: auto;\n    width: ",";\n    height: ",";\n    margin-top: ",";\n    border-radius: 50%;\n    border: 200px solid;\n    /*background-clip: padding-box;*/\n  }\n  .tagName{\n      z-index:999;\n  }\n  .container{\n    text-align:center;\n    height:200px;\n    line-height:200px;\n    font-size:50px;\n    font-weight:900;\n    color:white;\n  }\n"])),.9*(document.documentElement.clientWidth-250)+"px",.9*(document.documentElement.clientWidth-250)+"px",.4*-(document.documentElement.clientWidth-250)+"px");function Ae(){var t=Math.floor(192*Math.random()),e=Math.floor(192*Math.random()),a=Math.floor(192*Math.random());return"#"+(1===t.toString(16).length&&t.toString(16)<="f"?0+t.toString(16):t.toString(16))+(1===e.toString(16).length&&e.toString(16)<="f"?0+e.toString(16):e.toString(16))+(1===a.toString(16).length&&a.toString(16)<="f"?0+a.toString(16):a.toString(16))}var Te=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).state={tagName:"",data:[],pages:0,platform_address:""},n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;Q.subscribe((function(){if(Q.getState().globalConfig.globalConfig){var e=Q.getState().globalConfig.globalConfig.menu;t.setState({platform_address:e.platform_address})}})),it.get(this.props.location.pathname).then((function(e){200===e.data.code?(console.log(e.data.content),t.setState({tagName:e.data.content.tag.name}),t.setState({data:e.data.content.page.records}),t.setState({total:e.data.content.page.total})):(kt.b.error(e.data.message),window.location.href=t.state.platform_address)})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return Object(Y.jsxs)("div",{children:[Object(Y.jsx)(Le,{children:Object(Y.jsx)("div",{children:Object(Y.jsxs)("div",{className:"circle",style:{backgroundColor:Ae()},children:[Object(Y.jsx)("p",{className:"container",children:this.state.tagName}),Object(Y.jsx)("div",{className:"circle-shadow",style:{borderColor:Ae(),backgroundColor:Ae()}})]})})}),Object(Y.jsx)(Oe.a,{className:"site-page-header",onBack:function(){window.history.back(-1)},title:this.state.tagName}),Object(Y.jsx)(vt,{data:this.state.data}),Object(Y.jsx)(Z,{children:Object(Y.jsx)("div",{className:"pagination",children:Object(Y.jsx)(yt.a,{showQuickJumper:!0,defaultCurrent:1,total:this.state.total,onChange:function(e){it.get(t.props.location.pathname,{params:{pageNo:e}}).then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))},justify:"center",pageSize:15})})})]})}}]),a}(l.a.Component),De=Object(w.b)((function(t){return{globalConfig:t.globalConfig.globalConfig}}))(Te),Ee=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).state={data:[],pages:0},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;it.get(this.props.location.pathname).then((function(e){200===e.data.code?(t.setState({data:e.data.content.article.records}),t.setState({total:e.data.content.article.total}),t.setState({name:e.data.content.user.username})):(kt.b.error(e.data.messgae),window.location.href=t.props.globalConfig.menu.platform_address)})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return Object(Y.jsx)(Z,{children:Object(Y.jsxs)("div",{className:"main",children:[Object(Y.jsx)(Oe.a,{className:"site-page-header",onBack:function(){window.history.back(-1)},title:this.state.name+"\u53d1\u8868\u7684\u6587\u7ae0"}),",",Object(Y.jsx)(vt,{data:this.state.data}),Object(Y.jsx)("div",{className:"pagination",children:Object(Y.jsx)(yt.a,{showQuickJumper:!0,defaultCurrent:1,total:this.state.total,onChange:function(e){it.get("this.props.location.pathname",{pageNo:e}).then((function(e){t.setState({data:e.data.content.article.records}),t.setState({total:e.data.content.article.total})})).catch((function(t){console.log(t)}))},justify:"center",pageSize:15})})]})})}}]),a}(l.a.Component),Re=Object(At.withRouter)(Object(w.b)((function(t){return{globalConfig:t.globalConfig.globalConfig}}))(Ee)),We=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).state={data:[],pages:0},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var t=this;it.get("/notification/list").then((function(e){200===e.data.code?(t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})):(kt.b.error(e.data.messgae),window.location.href="/")})).catch((function(t){console.log(t)}))}},{key:"generateNotificationContent",value:function(t,e,a,n,s){var o="";switch(a){case"broadcast":return Object(Y.jsxs)("p",{children:["\u7ba1\u7406\u5458\u53d1\u9001\u4e86\u5168\u7ad9\u5e7f\u64ad\u8bf4\uff1a",t," "]});case"COMMENT":o="\u8bc4\u8bba";break;case"COLLECT":o="\u6536\u85cf"}return Object(Y.jsxs)("p",{children:[n,"  ",o,"\u4e86\u4f60\u7684\u6587\u7ae0  ",Object(Y.jsx)(X.Link,{to:"/article/"+e,children:s}),"  ",t?Object(Y.jsxs)("span",{children:["\u8bf4\uff1a",t]}):null]})}},{key:"render",value:function(){var t=this;return this.props.userState.isAuth||(kt.b.error("\u8bf7\u5148\u767b\u5f55!"),window.location.href="/"),console.log(this.state.data),Object(Y.jsx)(Z,{children:Object(Y.jsxs)("div",{className:"main",children:[Object(Y.jsx)(Oe.a,{className:"site-page-header",onBack:function(){window.history.back(-1)},title:"\u6211\u7684\u6d88\u606f"}),",",Object(Y.jsx)(ht.b,{style:{width:"50%",margin:"0 auto"},itemLayout:"horizontal",dataSource:this.state.data,renderItem:function(e){return Object(Y.jsx)(ht.b.Item,{onMouseDown:function(){it.get("/notification/mark").catch((function(t){console.log(t)}))},children:Object(Y.jsx)(ht.b.Item.Meta,{avatar:Object(Y.jsxs)(X.Link,{to:{pathname:"/user/"+e.user_id},children:[" ",e.avatar?Object(Y.jsx)(jt.a,{src:e.avatar}):null]}),title:Object(Y.jsx)(X.Link,{to:{pathname:"/user/"+e.user_id},children:e.username}),description:t.generateNotificationContent(e.content,e.article_id,e.ACTION,e.username,e.title)})})}}),Object(Y.jsx)("div",{className:"pagination",children:Object(Y.jsx)(yt.a,{showQuickJumper:!0,defaultCurrent:1,total:this.state.total,onChange:function(e){it.get("/notification/list/"+t.props.userState.user.id,{pageNo:e}).then((function(e){t.setState({data:e.data.content.records}),t.setState({total:e.data.content.total})})).catch((function(t){console.log(t)}))},justify:"center",pageSize:15})})]})})}}]),a}(l.a.Component),ze=Object(At.withRouter)(Object(w.b)((function(t){return{userState:t.login}}))(We)),Be={margin:"0 0 0 250px",display:"block",background:"#fff"},Ue=function(t){Object(b.a)(a,t);var e=Object(p.a)(a);function a(){var t;return Object(h.a)(this,a),(t=e.call(this)).state={menuData:[]},t}return Object(j.a)(a,[{key:"componentDidMount",value:function(){Me(),Ie(),function(){var t={username:"",id:"",avatar:""};localStorage.BBSToken?it.post("/token",localStorage.BBSToken).then((function(e){var a=e.data.content.token;localStorage.setItem(nt,a),Nt(a),t.username=e.data.content.user.username,t.id=e.data.content.user.id,t.avatar=e.data.content.user.avatar,Q.dispatch(Mt(t))})).catch((function(t){console.log(t)})):Q.dispatch(Mt(t))}()}},{key:"render",value:function(){return Object(Y.jsx)(C.a,{children:Object(Y.jsxs)("div",{children:[Object(Y.jsx)(q,{}),Object(Y.jsx)(Bt,{}),Object(Y.jsx)(be,{}),Object(Y.jsxs)("div",{style:Be,children:[Object(Y.jsx)(At.Route,{exact:!0,path:"/",component:St}),Object(Y.jsx)(At.Route,{path:"/home",component:St}),Object(Y.jsx)(At.Route,{path:"/articleList",component:V}),Object(Y.jsx)(At.Route,{path:"/article/*",component:te}),Object(Y.jsx)(At.Route,{path:"/searchPage",component:ne}),Object(Y.jsx)(At.Route,{path:"/signup",component:de}),Object(Y.jsx)(At.Route,{path:"/login",component:fe}),Object(Y.jsx)(At.Route,{path:"/myArticle",component:ve}),Object(Y.jsx)(At.Route,{path:"/myCollect",component:Se}),Object(Y.jsx)(At.Route,{path:"/myMessage",component:ze}),Object(Y.jsx)(At.Route,{path:"/create",component:we}),Object(Y.jsx)(At.Route,{path:"/edit",component:_e}),Object(Y.jsx)(At.Route,{path:"/tag/*",component:De}),Object(Y.jsx)(At.Route,{path:"/user/*",component:Re})]})]})})}}]),a}(l.a.Component);u.a.render(Object(Y.jsx)(w.a,{store:Q,children:Object(Y.jsx)(Ue,{})}),document.getElementById("root"))}},[[298,1,2]]]);
//# sourceMappingURL=main.e21c3c06.chunk.js.map